define tapetype <%= @node['amanda_part']['server']['s3']['tapetype']['name'] %> {
    length <%= @node['amanda_part']['server']['s3']['tapetype']['length'] %>
}

define changer <%= @node['amanda_part']['server']['s3']['tpchanger']['name'] %> {
    tpchanger "chg-multi:s3:<%= @node['amanda_part']['server']['s3']['tpchanger']['bucket_name'] %>/<%= @config[:role] %>/<%= @config[:disk_postfix] %>/slot-{<%= @node['amanda_part']['server']['s3']['tpchanger']['slots'] %>}"
    device-property "S3_ACCESS_KEY" "<%= @node['amanda_part']['server']['s3']['tpchanger']['s3_access_key'] %>"
    device-property "S3_SECRET_KEY" "<%= @node['amanda_part']['server']['s3']['tpchanger']['s3_secret_key'] %>"
    device-property "S3_BUCKET_LOCATION" "<%= @node['amanda_part']['server']['s3']['tpchanger']['s3_bucket_location'] %>"
    device-property "NB_THREADS_BACKUP" "<%= @node['amanda_part']['server']['s3']['tpchanger']['threads'] %>"
    device-property "S3_SSL" "<%= @node['amanda_part']['server']['s3']['tpchanger']['s3_ssl'] %>"
    changerfile  "<%= @node['amanda_part']['server']['s3']['tpchanger']['changerfile'] %>"
}
